---
title: 鉴权
lastUpdated: true
---

# 鉴权

[参考](https://mp.weixin.qq.com/s/cr-wM827LJCqswJ5qVZ49w)

##

- 认证：Identification 根据声明者所特有的识别信息确认声明者身份，比如身份证、指纹、密码等
- 授权：Authorization 在信息安全领域指 `资源所有者委派执行者` 赋予执行者指定范围等资源操作权限，比如门禁卡、web 服务器的 session、web 浏览器的 cookie 机制、token 机制
- 鉴权：Authentication 指对于一个声明者所声明的身份权利，进行真实性鉴别确认的过程

授权和鉴权是两个上下游相匹配的关系，先授权，后鉴权，比如发给你门禁卡是授权，你刷卡进门的时候需要鉴权、校验 session/cookie/token 的合法性和有效性

认证 ---> 授权 ---> 鉴权 ---> 权限控制

## HTTP 基本鉴权

1.client 发送请求请求一个受限的资源 2.服务器返回 401 Unauthorized
3.client 收到后弹框询问用户 4.确认后携带 Base64 格式的用户名密码再次请求 5.服务器进行身份校验 6.校验成功返回 200 资源，校验失败 返回 403 Forbindden

不安全，HTTP 传输不安全，Base64 编码也很容易解码，就算无法解码，恶意用户获取认证内容之后也可以使用其不断发起请求，进行重放攻击

无法主动注销，HTTP 协议没有提供机制清除认证信息

一般在内部网络使用，或者对安全要求不高时使用

## Session-Cookie 鉴权

利用服务端的 Session(会话) 和客户端的 Cookie 来实现前后端通信认证模式

### Cookie

HTTP 是无状态协议，对于事物处理没有记忆功能，每次会话完成时服务端不会保存任何会话信息
所以为了让服务器区分不同的客户端，必须主动维护一个状态，用于告知服务端前后两个请求是否来自同一浏览器

特点：

1. Cookie 存储在客户端，可以随意篡改，不安全
2. 有大小限制，最大 4kb
3. 有数量限制，一般一个浏览器对于一个网站只能存不超过 20 个 Cookie，浏览器一般只允许存放 300 个 cookie
4. Android 和 IOS 对 Cookie 支持性不好
5. Cookie 是不可跨域的，但是一级域名和二级域名是允许共享使用的（靠 domain）

### Session

流程：

1. 客户端向服务器首次发送请求
2. 服务器接收到数据并自动为该用户创建特定的 session/session ID 来标识用户并跟踪用户当前的会话过程
3. 客户端收到响应获取会话信息，并在下一次请求时带上 session/session ID
4. 服务器提取后与本地保存的 session 进行对比，找到该用户的会话，进而获取会话状态
5. 至此客户端与服务器的无状态通信变成了有状态通信

特点：
session 保存在服务器上，通过服务器自带的加密协议进行

与 cookie 的区别：

1. 安全性：cookie 保存着客户端可以随意篡改，session 存储在服务器端无法伪造
2. 存取值类型不同：cookie 只支持字符串数据，session 可以存任意类型
3. 有效期不同：cookie 可以设置为长时间保持，session 一般失效时间较短
4. 大小：cookie 不超过 4k
